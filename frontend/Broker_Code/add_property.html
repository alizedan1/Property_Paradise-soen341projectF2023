<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Add New Property</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">

    /* /*html {
    height: 100%; /* Set the height of both elements to 100%
    background-color: #D18686;
    background-image: url(/soen341/images/bg-tt.jpg);
    background-repeat: no-repeat;
    background-size: cover;
    background-position: center bottom;
    background-attachment: fixed;
    min-height: 100%;
}*/

.main-bg {
    height: auto;
    background-image: url(/soen341/images/bg-g.jpg);
    background-size: cover;
    background-position: top center;
    min-height: 100vh;
}

.background-image {
    height: 100%;
    background-image: url(/soen341/images/bg-g.jpg);
    background-size: cover;
    background-position: top center;
    min-height: 100vh;
}

hr {
    height: 50px;
    border: none;
    background-color: transparent;
    color: #d5daf0;
}

h1 {
    margin-left: auto;
    margin-right: auto;
    margin-bottom: 10px;
    font-family: 'Lato', sans-serif;
    font-weight: 400;
}

h3 {
    margin-left: auto;
    margin-right: auto;
    font-family: 'Lato', sans-serif;
    font-weight: 400;
}

h2 {
    margin-left: auto;
    margin-right: auto;
    font-family: 'Lato', sans-serif;
    font-weight: 400;
}







.brand-name {
    transition: font-size 0.5s ease-in-out;
}

.brand-name:hover{
    color: #91B7FB;
    font-size: 3vw;
    transition: 0.5s;
}
.row h3 {
    transition: font-size 0.3s ease-in-out;
    color: black;
}

.row:hover h3 {
    font-size: 1vw;
    color: #54a2ec;
    transition: 0.20s;
}

.cell h2 {
    transition: font-size 0.3s ease-in-out;
    color: white;
}

.cell:hover h2 {
    font-size: 1vw;
    color: #716adb;
    transition: 0.20s;
}



.carousel-image {
   border-radius: 40px;

   width: 65%;
   height: auto;
   margin: auto;
}

.carousel-text {
    font-size: 1vw;
    font-weight: 400;
    color: #FBC5BD;
}

.navbar-text {
    font-size: 1.2em;
    font-weight: 400;
}

.navbar .navbar-nav .nav-link:hover {
    color: #91B7FB;

    border-radius: 50px;
    border: none;
}

.navbar .navbar-nav .nav-link {
    color: white;
    transition: 0.35s;
}

.summon-font {
    font-family: 'Lato', sans-serif;
    font-weight: 400;
}

.text-white {
    color: white;
}

.text-red {
    color: #E09393;
}

.text-black {
   color: #000000;
}

.text-about {
    width: 70%;
    height: auto;
    text-align: center;
    margin: 50% auto 10% auto;
    padding: 20px;
}

.sign-up-text {
    font-size: 1.5vw;
}

.profile_buttons {
    margin: auto;
    text-align: center;
    margin-top: 4%;
}

.postings-size {
    font-size: 0.9vw;
    font-family: 'Lato', sans-serif;
    font-weight: 400;
}


.container {
    padding-top: 3%;
}
.form-signup, .form-login {
    background-color: #f7f7f7;
    padding: 20px;
    border-radius: 10px;
}
.form-control {
    margin-bottom: 10px;
}
.btn-submit {
    margin-top: 10px;
}

/*
    This code was taken from CodePen
    https://codepen.io/jmptr/pen/MWaVzNK
*/
.outer:hover {
    box-shadow: var(--outer-shadow);
    transition: 0.4s;
    background-color: #007bff;
}

.outer2:hover {
    box-shadow: var(--outer2-shadow2);
    transition: 0.4s;
    background-color: #FFFFFF;
}

:root {
--outer2-shadow2: 
    0 0 0.1vw 0.2vw #ffffff,
    0 0 0.4vw 0.6vw #c5ccd3,
    0 0 1vw 0.4vw #767680;
--outer-shadow: 
    0 0 0.1vw 0.2vw #b1fcfc,
    0 0 0.4vw 0.6vw #54a2ec,
    0 0 1vw 0.4vw #007bff;
}







input[type="text"] {
    border: none;
    border-radius: 5px;
    padding: 10px;
    margin-bottom: 10px;
    box-shadow: 0px 0px 5px rgba(0, 0, 0, 0.1);
    width: 300px;
    font-size: 1vw;

    margin-right: 5%;
}

input[type="text"]:focus {
    outline: none;
    box-shadow: 0px 0px 5px rgba(0, 0, 0, 0.3);
}

.searchbtn {
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 5px;
    padding: 10px 20px;
    font-size: 1vw;
    cursor: pointer;
    transition: background-color 0.2s ease-in-out;
    margin-left: 2%;
}

.searchbtn:hover {
    box-shadow: var(--outer-shadow);
    transition: 0.4s;
    background-color: #007bff;
}

.closebtn {
    background-color: white;
    color: black;
    border: none;
    border-radius: 5px;
    padding: 10px 20px;
    font-size: 1vw;
    cursor: pointer;
    transition: background-color 0.2s ease-in-out;
    margin-left: 6%;
}

.closebtn:hover {
    box-shadow: var(--outer2-shadow2);
    transition: 0.4s;
    background-color: white;
}

.interview_button {
    align-items: center;
    justify-content: center;
} 


.form-container {
    background-color: #cccbf3;
    height: 30%;
    width: 60%;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    padding: 20px;
    z-index: 9999;
    border: 5px solid black; 
    
    margin-left: auto;
    margin-right: auto;
    font-family: 'Lato', sans-serif;
    font-weight: 400;
  }






    
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="#">Broker Portal</a>
    </nav>

    <header class="container mt-5 text-center">
         <!-- Check if user is signed in -->
        <!-- 
        <script>
            firebase.auth().onAuthStateChanged(function(user) {
                if (user) {
                    // User is signed in
                    console.log('User is signed in:', user.displayName);
                } else {
                    // User is not signed in
                    console.log('User is not signed in');
                }
            });
        </script>
        -->
        <h1>Add New Property</h1>
        <p>Provide all the details of the Property</p>
    </header>

    <!-- Property details Form more can be added in the future-->
    <div class="container mt-5">
        <form id="propertyForm">
            <div class="form-group">
                <label for="rentOrBuy">Rent or Buy</label>
                <select class="form-control" id="rentOrBuy" name="rentOrBuy" required>
                    <option value="Rent">Rent</option>
                    <option value="Buy">Buy</option>
                </select>
            </div>
            <div class="form-group">
                <label for="location">Location</label>
                <input type="text" class="form-control" id="location" name="location" required>
            </div>
            <div class="form-group">
                <label for="price">Price</label>
                <input type="text" class="form-control" id="price" name="price" required>
            </div>
            <div class="form-group">
                <label for="bedrooms">Number of Bedrooms</label>
                <input type="number" class="form-control" id="bedrooms" name="bedrooms" required>
            </div>
            <div class="form-group">
                <label for="dimensions">Dimensions</label>
                <input type="text" class="form-control" id="dimensions" name="dimensions" required>
            </div>
            <div class="form-group">
                <label for="releaseDate">Release Date</label>
                <input type="date" class="form-control" id="releaseDate" name="releaseDate" required>
            </div>
            <div class="form-group">
                <label for="propertyYear">Property Year</label>
                <input type="number" class="form-control" id="propertyYear" name="propertyYear" required>
            </div>
            <div class="form-group">
                <label for="propertyType">Property Type</label>
                <input type="text" class="form-control" id="propertyType" name="propertyType" required>
            </div>
            <div class="form-group">
                <label for="brokerName">Broker's Name</label>
                <input type="text" class="form-control" id="brokerName" name="brokerName" required>
            </div>
            <div class="form-group">
                <label for="propertyTitle">Property Title</label>
                <input type="text" class="form-control" id="propertyTitle" name="propertyTitle" required>
            </div>
            <div class="form-group">
                <label for="description">Description</label>
                <textarea class="form-control" id="description" name="description" rows="5" required></textarea>
            </div>
            <div class="form-group">
                <label for="propertyImages">Images of Property (select multiple)</label>
                <input type="file" class="form-control-file" id="propertyImages" name="propertyImages" accept="image/*" multiple required>
            </div>
            <button type="submit" class="btn btn-primary">Submit</button>
        </form>
    </div>
    <div class="container mt-3 text-center">
        <a href="broker.html" class="btn btn-secondary">Return to My Properties</a>
    </div>

    <!-- JavaScript to send submission to firebase-->
<script>
   document.getElementById('propertyForm').addEventListener('submit', function(e) {
    e.preventDefault();

    var rentOrBuy = document.getElementById('rentOrBuy').value;
    var location = document.getElementById('location').value;
    var price = document.getElementById('price').value;
    var bedrooms = document.getElementById('bedrooms').value;
    var dimensions = document.getElementById('dimensions').value;
    var releaseDate = document.getElementById('releaseDate').value;
    var propertyYear = document.getElementById('propertyYear').value;
    var propertyType = document.getElementById('propertyType').value;
    var brokerName = document.getElementById('brokerName').value;
    var propertyTitle = document.getElementById('propertyTitle').value;

    // Get selected image files
    var propertyImages = document.getElementById('propertyImages').files;
    var imageUrls = [];

    // Function to handle image upload and get download URL
    function uploadImage(imageFile) {
        var storageRef = firebase.storage().ref('property_images/' + imageFile.name);

        storageRef.put(imageFile).then(function(snapshot) {
            snapshot.ref.getDownloadURL().then(function(downloadURL) {
                imageUrls.push(downloadURL);
                if (imageUrls.length === propertyImages.length) {
                    var propertyData = {
                        rentOrBuy: rentOrBuy,
                        location: location,
                        price: price,
                        bedrooms: bedrooms,
                        dimensions: dimensions,
                        releaseDate: releaseDate,
                        propertyYear: propertyYear,
                        propertyType: propertyType,
                        brokerName: brokerName,
                        propertyTitle: propertyTitle,
                        propertyImages: imageUrls
                    };

                    // Send data to Firebase
                    var propertyRef = firebase.database().ref('properties').push(propertyData);
                    var propertyId = propertyRef.key;

                    alert('Property added successfully!');
                }
            });
        });
    }

    // Upload each selected image
    for (var i = 0; i < propertyImages.length; i++) {
        uploadImage(propertyImages[i]);
    }
});
    </script>
    <script src="firebase-config.js"></script>
    <script src="property.js"></script>
    <script src="broker.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"></script>
</body>
</html>

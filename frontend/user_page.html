<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>My Uploaded Properties</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
    <script src="https://www.gstatic.com/firebasejs/4.5.0/firebase.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.5.0/firebase-firestore.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="../firebase-config.js"></script>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="#">User Portal</a>
    </nav>

    <header class="container mt-5 text-center">
        <h1>Search For Properties</h1>
    </header>

    <div class="container mt-3">
        <div class="form-inline">
            <!-- Input fields for search criteria -->
            <div class="form-group mr-2">
                <label>Location</label>
                <input class="form-control" type="text" placeholder="Location" id="locationInput">
            </div>
            <div class="form-group mr-2">
                <label>Minimum Price</label>

                <input class="form-control" type="number" placeholder="Min Price" id="minPriceInput">
            </div>
            <div class="form-group mr-2">
                <label>Maximum Price</label>

                <input class="form-control" type="number" placeholder="Max Price" id="maxPriceInput">
            </div>
            <div class="form-group mr-2">
                <label>Number of bedrooms</label>

                <input class="form-control" type="number" placeholder="Bedrooms" id="bedroomsInput">
            </div>
            <div class="form-group mr-2">
                <label>Amenities</label>

                <input class="form-control" type="text" placeholder="Amenities" id="amenitiesInput">
            </div>

            <div class="form-group mr-2">
                <label>Broker</label>

                <input class="form-control" type="text" placeholder="Broker" id="bedroomsInput">
            </div>
            <!-- Search button -->
            <button class="btn btn-outline-success" type="button" id="searchBtn">Search</button>
        </div>
        <!-- Display search results here -->
        <div id="searchResults" class="mt-4"></div>
    </div>

    <script>
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        var db = firebase.firestore();

        document.getElementById('searchBtn').addEventListener('click', function () {
            var location = document.getElementById('locationInput').value.toLowerCase();
            var minPrice = parseFloat(document.getElementById('minPriceInput').value) || 0;
            var maxPrice = parseFloat(document.getElementById('maxPriceInput').value) || Infinity;
            var bedrooms = parseInt(document.getElementById('bedroomsInput').value) || 0;
            var amenities = document.getElementById('amenitiesInput').value.toLowerCase();

            // Perform Firebase query based on search criteria
            db.collection('properties')
                .where('location', '==', location)
                .where('price', '>=', minPrice)
                .where('price', '<=', maxPrice)
                .where('bedrooms', '==', bedrooms)
                .where('amenities', 'array-contains', amenities)
                .get()
                .then(function (querySnapshot) {
                    // Display search results
                    var resultsContainer = document.getElementById('searchResults');
                    resultsContainer.innerHTML = '';
                    querySnapshot.forEach(function (doc) {

                        var propertyData = doc.data();
                        var propertyElement = document.createElement('div');
                        propertyElement.textContent = JSON.stringify(propertyData);
                        resultsContainer.appendChild(propertyElement);
                    });
                })
                .catch(function (error) {
                    console.log('Error searching properties: ', error);
                });
        });
    </script>
</body>

</html>